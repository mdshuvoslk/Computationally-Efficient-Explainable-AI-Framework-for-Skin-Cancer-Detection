count = 0
for f1 in files:
    count += 1
    print("**", count, "**")
    # load an image from file
    image = load_img(f1, target_size=(224, 224))
    # Find the best filter
    best_filter = applyFilter(image)
    # apply the best filter by using the value of Smaller value of MSE and Higher value of PSNR
    filtered_image = applyFilterToImage(image, best_filter)
    # Show the image
    plt.figure(figsize=(1, 1))
    plt.imshow(image)
    plt.axis('off')
    plt.show()

    # convert the image pixels to a numpy array
    image = img_to_array(filtered_image)
    # reshape data for the model
    image = image.reshape((1, image.shape[0], image.shape[1], image.shape[2]))
    # prepare the image for the ResNet50 model
    image = preprocess_input(image)
    # load model
    model = ResNet50()
    # remove the output layer
    model = Model(inputs=model.inputs, outputs=model.layers[-2].output)
    # get extracted features
    features = model.predict(image)

    for i in range(2048):
        p = features[0, i]
        file.write(str(p))
        file.write(",")
    file.write("0\n")
